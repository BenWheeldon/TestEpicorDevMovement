{"Mode":"Backup","Version":"4.2.400","SystemCode":"ERP","LibraryId":"CBO-Utilities","Library":{"OriginalID":"CBO-Utilities","Description":"CBO-Utilities","GlobalID":"2754faa3-27dd-46e7-8cd4-148d2a180047","EpicorVersion":"4.2.200","Revision":14,"Published":true,"Private":false,"Disabled":false,"Mode":0,"AllowCustomCodeWidgets":true,"AllowCustomCodeFunctions":true,"DirectDBAccess":2,"OwnedByCompany":"EPIC03","Owner":"ben.wheeldon","Functions":[{"FunctionID":"EnableDisableBasicAuthinBrowserHomePage","Kind":2,"RequireTransaction":false,"SingleRowMode":false,"Private":false,"Disabled":false,"Invalid":false,"Thumbnail":null,"Body":"{\"Code\":\"var curSysConfig = Db.SysConfig.Where(r => r.Key1 == \\\"AdvertiseAuthentication\\\" && r.Key2 == \\\"Basic\\\").FirstOrDefault();\\r\\n\\r\\nif (curSysConfig != null)\\r\\n{\\r\\n  if (curSysConfig.SysCharacter01 != Convert.ToString(this.enabled))\\r\\n  {\\r\\n    curSysConfig.SysCharacter01 = Convert.ToString(this.enabled);\\r\\n    \\r\\n    Db.SaveChanges();\\r\\n  }\\r\\n}\\r\\nelse\\r\\n{\\r\\nvar newRow = new Ice.Tables.SysConfig();\\r\\n\\r\\n  newRow.Key1 = \\\"AdvertiseAuthentication\\\";\\r\\n  newRow.Key2 = \\\"Basic\\\";\\r\\n  newRow.SysCharacter01 = Convert.ToString(this.enabled);\\r\\n\\r\\n  Db.AddObject(newRow);\\r\\n      Db.SaveChanges();\\r\\n}\",\"Usings\":\"\"}","FunctionSignature":[{"Response":false,"ParameterID":1,"ArgumentName":"enabled","Order":1,"DataType":"System.Boolean","Optional":false}]},{"FunctionID":"RestartTaskAgent","Kind":2,"RequireTransaction":false,"SingleRowMode":false,"Private":false,"Disabled":false,"Invalid":false,"Thumbnail":null,"Body":"{\"Code\":\"string version = Db.ICEVer.Where(r => r.SystemCode == \\\"Ice\\\").OrderByDescending(r => r.SystemDate).Select(r => r.SystemVersion).FirstOrDefault();\\r\\n\\r\\nstring[] lVer = version.Split(\\\".\\\");\\r\\n\\r\\nstring baseVersion = $\\\"{lVer[0]}.{lVer[1]}.{lVer[2]}\\\";\\r\\n\\r\\nforeach (var taskAgent in Db.ExtServiceRegistration)\\r\\n{\\r\\n\\r\\n//Process.Start(\\\"powershell.exe\\\",\\\"-command \\\\\\\"Restart-Service EpicorICETaskAgent\\\" + baseVersion + \\\" -Force\\\\\\\"\\\");\\r\\n\\r\\nIce.Diagnostics.Log.WriteEntry($\\\"Running Admin Tools restart task agent for server {taskAgent.ServerName}, service name EpicorICETaskAgent{baseVersion}. User { Session.UserID}\\\");\\r\\nProcess.Start(\\\"powershell.exe\\\",\\\"-command \\\\\\\"Get-Service EpicorICETaskAgent\\\" + baseVersion + \\\" -computer \\\" + taskAgent.ServerName + \\\" | Restart-Service \\\\\\\"\\\");\\r\\n\\r\\n}\\r\\n\\r\\nPublishInfoMessage($\\\"Task Agents restarted for server/s {String.Join(',',Db.ExtServiceRegistration.Select(r => r.ServerName).ToList())}, please allow 5 minutes for them to boot back up.\\\", Ice.Common.BusinessObjectMessageType.Information, Ice.Bpm.InfoMessageDisplayMode.Individual, \\\"CBO-Utilities\\\", \\\"RestartTaskAgent\\\");\\r\\n\",\"Usings\":\"using System.Diagnostics;\"}"}],"LibraryReferences":[{"ReferenceType":1,"ReferenceID":"ICE.ExtServiceRegistration","Updatable":false},{"ReferenceType":1,"ReferenceID":"ICE.ICEVer","Updatable":false},{"ReferenceType":1,"ReferenceID":"ICE.SysConfig","Updatable":true}],"LibraryMappings":[{"Company":"EPIC01","Allowed":true},{"Company":"EPIC02","Allowed":true},{"Company":"EPIC03","Allowed":true},{"Company":"EPIC04","Allowed":true},{"Company":"EPIC05","Allowed":true},{"Company":"EPIC06","Allowed":true},{"Company":"EPIC07","Allowed":true},{"Company":"EPIC08","Allowed":true},{"Company":"EPIC09","Allowed":true},{"Company":"GPC","Allowed":true}]}}